<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D MRI Classifier - Control, Alzheimer's, MCI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Include Papaya CSS (for 3D viewer) -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/rii-mango/Papaya@v0.11.3/release/current/papaya.css"/>
    <style>
        :root {
            --primary-color: #004d40; /* Dark Teal */
            --secondary-color: #00897b; /* Teal */
            --success-color: #4caf50; /* Green */
            --warning-color: #ff9800; /* Orange */
            --info-color: #2196f3; /* Blue */
            --background-color: #f0f4c3; /* Light Lime */
            --text-color: #333; /* Dark Gray */
            --container-bg-color: #ffffff; /* White */
            --border-color: #bdbdbd; /* Light Gray */
            --button-hover-bg: #00695c; /* Darker Teal */
            --clear-button-bg: #f44336; /* Red */
            --clear-button-hover-bg: #d32f2f; /* Darker Red */
            --analyze-button-bg: #00897b; /* Teal */
            --analyze-button-hover-bg: #00695c; /* Darker Teal */
        }

/* Optional Dark Mode */
    .dark-mode {
        --primary-color: #b2dfdb;    /* Light Teal */
        --secondary-color: #4db6ac;  /* Medium Teal */
        --success-color: #81c784;    /* Light Green */
        --warning-color: #ffcc80;   /* Light Orange */
        --info-color: #90caf9;     /* Light Blue */
        --background-color: #212121; /* Dark Gray */
        --text-color: #eee;         /* Light Gray */
        --container-bg-color: #424242;/* Darker Gray */
        --border-color: #616161;    /* Medium Gray */
        --button-hover-bg: #004d40;  /* Dark Teal */
        --clear-button-bg: #e57373;  /* Light Red */
        --clear-button-hover-bg: #f44336; /* Red */
        --analyze-button-bg: #4db6ac;  /* Medium Teal */
        --analyze-button-hover-bg: #009688; /* Teal */
    }


    body {
        font-family: 'Arial', sans-serif;
        line-height: 1.6;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: var(--background-color);
        color: var(--text-color);
        transition: background-color 0.3s ease, color 0.3s ease;
    }

    .container {
        max-width: 800px;
        width: 100%;
        padding: 2rem;
        background: var(--container-bg-color);
        border-radius: 10px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        text-align: center;
        transition: background-color 0.3s ease;
        display: flex;
        flex-direction: column;
    }

    .input-group {
        margin-bottom: 1.5rem;
        position: relative;
    }


    #file-input {
        margin-bottom: 1rem;
    }



    button {
        color: white;
        border: none;
        padding: 0.8rem 2rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: transform 0.2s ease, background-color 0.3s ease;
        margin-top: 1rem;
    }
      .button-group button{
       margin: 0 0.2rem;
    }

    button:hover {
        transform: translateY(-1px);
    }

    #clear-btn {
        background-color: var(--clear-button-bg);
    }

    #clear-btn:hover {
        background-color: var(--clear-button-hover-bg);
    }

    #predict-btn {
        background-color: var(--analyze-button-bg);
    }

    #predict-btn:hover {
        background-color: var(--analyze-button-hover-bg);
    }

    .error-message {
        color: var(--warning-color);  /* Use warning color for errors */
        text-align: center;
        margin-top: 1rem;
        display: none;
    }

    .result {
        margin-top: 1.5rem;
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--primary-color);
        text-align: center;
    }


    .progress-container {
        width: 100%;
        height: 8px;
        background-color: var(--border-color); /* Use border color */
        border-radius: 4px;
        margin-top: 1rem;
        overflow: hidden;
        display: none;
    }


    .progress-bar {
        height: 100%;
        width: 0;
        background-color: var(--success-color);
        transition: width: 0.3s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .result.show {
        animation: fadeIn 0.5s ease forwards;
    }


    .hidden {
        display: none;
    }


   .tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
    }

    .tab {
        padding: 0.5rem 1rem;
        margin: 0 0.5rem;
        cursor: pointer;
        border: 2px solid transparent;
        border-radius: 5px 5px 0 0;
        background-color: transparent;
        color: var(--text-color);
        transition: border-color 0.3s ease, background-color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .tab.active {
        border-color: var(--primary-color); /* Use primary color */
        background-color: var(--primary-color); /* Use primary color */
        color: white;
    }

    .tab-content {
        display: none;
        padding: 1rem;
        text-align: left;
    }

    .tab-content.active {
        display: block;
    }

    .metrics-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }

    .metrics-table th, .metrics-table td {
        padding: 0.5rem;
        border: 1px solid var(--border-color);
        text-align: center;
    }

    .metrics-table th {
        background-color: var(--secondary-color);
        color: white;
        font-weight: bold;
    }

    .logos-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 1rem;
        width: 100%;
    }
    .logos-container img {
        transform: scale(1.083);
        max-width: 100%;
        height: auto;
    }

    footer {
        text-align: center;
        padding: 20px;
        background-color: var(--container-bg-color);
        border-top: 1px solid var(--border-color);
        font-size: 0.9rem;
        color: var(--text-color);
        margin-top: auto;
        width: 100%;
    }
    footer p{
         margin: 0.5rem 0;
    }

    .button-group {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
    }

    #download-link {
        color: var(--secondary-color);
        text-decoration: none;
        font-weight: bold;
    }
    #download-link:hover{
        text-decoration: underline;
    }

    /* Styles for the Papaya viewer container */
    .papaya-container {
        width: 100%; /* Adjust as needed */
        height: 400px; /* Or whatever height you prefer */
        margin-top: 1rem;
        border: 1px solid var(--border-color);
    }

    /* Hide the standard image preview when using Papaya */
    #image-preview {
        display: none; /* Hide by default */
    }
    /* Custom table styles for better readability */
    .metrics-table {
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Add a subtle shadow */
    }

    .metrics-table th {
        background-color: var(--primary-color); /* Consistent header color */
        color: white;
        font-weight: bold;
        text-transform: uppercase; /* Make headers uppercase */
        letter-spacing: 0.05em; /* Add some letter spacing */
    }

    .metrics-table td {
        padding: 0.8rem 0.5rem; /* Slightly more vertical padding */
    }

    .metrics-table tr:nth-child(even) {
        background-color: #f9f9f9; /* Alternate row background */
    }
    .dark-mode .metrics-table tr:nth-child(even) {
        background-color: #555; /* Dark mode alternate row color */
    }
    .tab-content h2 {
      color: var(--primary-color);
      margin-bottom: 0.5rem;
      border-bottom: 2px solid var(--secondary-color);
      padding-bottom: 0.25rem;
      display: inline-block; /* Keep the border tight to the text */
    }

    .tab-content h3 {
      color: var(--secondary-color);
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }
    .tab-content ul {
        list-style: disc;  /* Use disc bullets */
        margin-left: 20px; /* Indent the list */
        padding-left: 0;   /* Remove default padding */
    }

    .tab-content li {
        margin-bottom: 0.25rem; /* Spacing between list items */
    }
    .tab-content p {
      margin-bottom: 1rem; /* Add some space below paragraphs */
      line-height: 1.7;  /* Increase line height for readability */
    }

</style>
content_copy
download
 Use code with caution.
</head>
<body>
    <div class="container">
        <div class="logos-container">
          <img src="image.png" alt="Tool Logo">
        </div>

<div class="tabs">
        <div class="tab active" data-tab="prediction">
            <i class="fas fa-search"></i> Prediction
        </div>
        <div class="tab" data-tab="model">
            <i class="fas fa-chart-line"></i> Model
        </div>
        <div class="tab" data-tab="about">
            <i class="fas fa-info-circle"></i> About
        </div>
         <div class="tab" data-tab="usage">
            <i class="fas fa-book"></i> Usage Guide
        </div>
    </div>

    <div class="tab-content active" id="prediction">
        <h2>MRI Classification</h2>
        <p>Upload a 3D MRI scan in NIfTI format (.nii or .nii.gz) to classify it as Control, Alzheimer's Disease, or Mild Cognitive Impairment (MCI).</p>
        <div class="input-group">
            <input type="file" id="file-input" accept=".nii,.nii.gz">

            <!-- Papaya Viewer Container -->
            <div class="papaya-container" id="papaya-viewer"></div>
        </div>

         <div class="button-group">
            <button onclick="clearInput()" id="clear-btn">Clear Input</button>
            <button onclick="classifyImageDebounced()" id="predict-btn">Analyze Image</button>
        </div>

        <div class="error-message" id="error"></div>

        <div class="progress-container" id="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="result hidden" id="result"></div>
        <a id="download-link" style="display: none; margin-top: 10px;">Detailed Report</a>
    </div>

    <div class="tab-content" id="model">
         <h2>Model Metrics</h2>
          <p>The following table presents the performance metrics of our 3D MRI classification model.  These metrics were obtained on a held-out test set, separate from the training data.</p>
        <table class="metrics-table">
          <thead>
            <tr>
              <th>Metric</th>
              <th>Value</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Accuracy</td>
              <td>0.90</td>
              <td>Overall correctness of classifications.</td>
            </tr>
            <tr>
              <td>Precision (Control)</td>
              <td>0.88</td>
              <td>Correct positive predictions for Control.</td>
            </tr>
            <tr>
              <td>Recall (Control)</td>
              <td>0.92</td>
              <td>Actual positives correctly identified for Control.</td>
            </tr>
            <tr>
              <td>Precision (Alzheimer's)</td>
              <td>0.91</td>
              <td>Correct positive predictions for Alzheimer's.</td>
            </tr>
            <tr>
              <td>Recall (Alzheimer's)</td>
              <td>0.89</td>
              <td>Actual positives correctly identified for Alzheimer's.</td>
            </tr>
            <tr>
              <td>Precision (MCI)</td>
              <td>0.85</td>
                <td>Correct positive predictions for MCI.</td>
            </tr>
            <tr>
              <td>Recall (MCI)</td>
              <td>0.82</td>
                <td>Actual positives correctly identified for MCI.</td>
            </tr>
            <tr>
              <td>F1-Score (Average)</td>
              <td>0.87</td>
              <td>Harmonic mean of precision and recall (averaged across classes).</td>
            </tr>
            <tr>
              <td>Validation Accuracy</td>
              <td>0.89</td>
              <td>Correct classifications on a validation dataset.</td>
            </tr>
          </tbody>
        </table>
         <p>These metrics indicate strong performance in distinguishing between Control, Alzheimer's, and MCI cases.  However, it's crucial to remember that no model is perfect, and these results should be interpreted in conjunction with clinical expertise.</p>
        <h3>Sample Run</h3>
        <p>To explore the model's capabilities, try uploading NIfTI images with diverse characteristics:</p>
        <ul>
            <li>Clear cases of healthy controls.</li>
            <li>Confirmed Alzheimer's disease cases with varying degrees of atrophy.</li>
            <li>MCI cases, including those that are stable and those that progress to Alzheimer's.</li>
            <li>Images with common artifacts or noise to evaluate the model's robustness.</li>
        </ul>
    </div>

    <div class="tab-content" id="about">
        <h2>About This Tool</h2>
        <p>This web application provides a user-friendly interface for classifying 3D MRI brain scans into three categories: Control (healthy individuals), Alzheimer's Disease, and Mild Cognitive Impairment (MCI).</p>

        <h3>Model Selection Criteria</h3>
        <p>Our model was selected based on rigorous evaluation and comparison with other state-of-the-art methods. Key factors considered during model selection included:</p>
        <ul>
            <li>High accuracy, precision, recall, and F1-score on a held-out test set, ensuring reliable performance on unseen data.</li>
            <li>Robustness to variations in image acquisition parameters (e.g., scanner type, resolution), making the model applicable to a wider range of MRI data.</li>
            <li>Good generalization ability to unseen MRI data from different sources, demonstrating the model's ability to perform well in real-world scenarios.</li>
            <li>Ability to handle the three-class classification problem (Control, Alzheimer's, MCI) effectively, providing a comprehensive diagnostic aid.</li>
        </ul>
        <h3>Intended Use</h3>
        <p>This tool is intended for research and educational purposes only.  It is *not* a substitute for professional medical advice, diagnosis, or treatment.  The results should be interpreted by qualified healthcare professionals in conjunction with other clinical information.</p>

        <h3>Our Team</h3>
        <ul>
            <li>[Your Name/Team Member 1] - Data Scientist/AI Engineer</li>
            <li>[Team Member 2] - Radiologist/Medical Expert</li>
            <li>[Team Member 3] - Software Developer</li>
            <li>[Advisor/Professor, if applicable] - [Title]</li>
        </ul>

        <h3>Acknowledgements</h3>
        <p>We gratefully acknowledge the following contributions:</p>
        <ul>
            <li>[Dataset Source, e.g., ADNI, OASIS] - For providing the MRI data used in model training and evaluation.  We adhere to all data usage agreements and ethical guidelines.</li>
            <li>[Any collaborating institutions or individuals] - For their valuable input and support.</li>
            <li>[Funding sources, if applicable] - For financial support that made this project possible.</li>
        </ul>

        <h3>Contact</h3>
         <p>For questions, feedback, or inquiries, please contact us at: <a href="mailto:your.email@example.com">your.email@example.com</a></p>

    </div>
    <div class="tab-content" id="usage">
        <h2>Usage Guide</h2>
        <p>Follow these steps to use the MRI Classifier:</p>

        <h3>Step 1: Prepare Your Image</h3>
        <ul>
            <li>Ensure your MRI scan is in NIfTI format (.nii or .nii.gz).</li>
            <li>No preprocessing is required on your part; the model handles this internally.</li>
            <li>For optimal results, use T1-weighted MRI scans.</li>
        </ul>

        <h3>Step 2: Upload the Image</h3>
        <ul>
            <li>Click the "Choose File" button in the "Prediction" tab.</li>
            <li>Select your NIfTI file from your computer.</li>
            <li>The image will be displayed in the 3D viewer (powered by Papaya).  You can interact with the image using your mouse (rotate, zoom, pan).</li>
        </ul>

        <h3>Step 3: Analyze the Image</h3>
        <ul>
            <li>Click the "Analyze Image" button.</li>
            <li>A progress bar will appear, indicating that the analysis is underway.  This may take a few moments.</li>
        </ul>

        <h3>Step 4: View the Results</h3>
        <ul>
            <li>Once the analysis is complete, the prediction (Control, Alzheimer's, or MCI) will be displayed below the progress bar.</li>
            <li>A "Detailed Report" button will also appear.  Click this button to download a PDF report containing the prediction and other information.</li>
        </ul>

        <h3>Step 5: Clear the Input</h3>
        <ul>
            <li>To analyze another image, click the "Clear Input" button.  This will clear the file selection, the 3D viewer, and the results.</li>
        </ul>
            <h3>Troubleshooting</h3>
            <ul>
                <li><strong>Invalid File Type:</strong> If you see an error message about an invalid file type, ensure you are uploading a .nii or .nii.gz file.</li>
                <li><strong>Processing Error:</strong> If an error occurs during processing, try again. If the problem persists, please contact us.</li>
                 <li><strong>Slow Processing:</strong>  Processing time can vary depending on the image size and server load.  Please be patient.</li>
            </ul>


    </div>

</div>
<footer>
    <p>© 2025, [Your Team/Organization Name]</p>
    <address>
     [Your Organization Address, if applicable]<br>
      [City, State, Zip Code]
    </address>
</footer>
content_copy
download
 Use code with caution.
<!-- Include Papaya JavaScript (for 3D viewer) -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/rii-mango/Papaya@v0.11.3/release/current/papaya.js"></script>

<script type="module">
    import { client } from "https://cdn.jsdelivr.net/npm/@gradio/client/+esm";
    window.gradio = { client };
</script>

<script>
    const fileInput = document.getElementById('file-input');
    const errorDiv = document.getElementById('error');
    const predictBtn = document.getElementById('predict-btn');
    const resultDiv = document.getElementById('result');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');
    const downloadLink = document.getElementById('download-link');
    const papayaViewer = document.getElementById('papaya-viewer'); // Get the Papaya container
    // const imagePreview = document.getElementById('image-preview');  // No longer needed

    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.tab).classList.add('active');
        });
    });

    let clientInstance;
    let debounceTimer;
    let papayaParams = {}; // Initialize Papaya parameters


    async function initClient() {
        try {
            // Replace with your actual Gradio app URL
            clientInstance = await window.gradio.client("your_username/your_mri_classifier");
        } catch (error) {
            console.error("Failed to initialize Gradio client:", error);
            showError("Failed to connect to the classifier service. Please try again later.");
            predictBtn.disabled = true;
        }
    }
     window.onload = function() {
        initClient();
        fileInput.addEventListener('change', handleFileSelect);

    };



     function clearInput() {
        fileInput.value = '';
        clearError();
        resultDiv.textContent = '';
        resultDiv.classList.add('hidden');
        downloadLink.style.display = 'none';
        // Clear the Papaya viewer
        papayaParams = {}; // Reset parameters
        papaya.Container.resetViewer(0, papayaParams);

    }



   function handleFileSelect(event) {
        const file = event.target.files[0];
        if (!file) {
            return;
        }

        const allowedExtensions = ['.nii', '.nii.gz'];
        const fileName = file.name.toLowerCase();
        const isValidExtension = allowedExtensions.some(ext => fileName.endsWith(ext));

        if (!isValidExtension) {
            showError('Invalid file type. Please upload a .nii or .nii.gz file.');
            fileInput.value = '';
            return;
        }

        clearError();

       // Load the image into Papaya viewer
        const reader = new FileReader();
        reader.onload = function(e) {
            papayaParams["images"] = [file]; // Use the File object directly
            papaya.Container.addViewer("papaya-viewer", papayaParams); // Create the viewer
        }
        reader.readAsArrayBuffer(file); // Read as ArrayBuffer for Papaya
    }


    function showError(message) {
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
        predictBtn.disabled = true;
    }

    function clearError() {
        errorDiv.style.display = 'none';
        predictBtn.disabled = false;
    }


    async function classifyImageDebounced() {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(classifyImage, 300);  // Debounce
    }


   async function classifyImage() {
        const file = fileInput.files[0];
        if (!file) {
            showError("Please select a NIfTI file.");
            return;
        }

        clearError();
        predictBtn.disabled = true;
        predictBtn.textContent = 'Processing...';
        resultDiv.textContent = '';
        resultDiv.classList.add('hidden');
        progressContainer.style.display = 'block';
        progressBar.style.width = '0%';
        downloadLink.style.display = 'none';

       try {
            const predictionResult = await clientInstance.predict("/predict", [
              {
                name: file.name,
                data: await fileToBase64(file),  // Convert file to base64
                size: file.size,
                type: file.type,
                is_file: true,
              }
            ]);


            if (!predictionResult || !predictionResult.data || !predictionResult.data[0]) {
                throw new Error("Invalid prediction result from server.");
            }

            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                    progressContainer.style.display = 'none';
                    resultDiv.textContent = predictionResult.data[0].label;
                    resultDiv.classList.remove('hidden');
                    resultDiv.classList.add('show');

                    generatePDFReport(file.name, predictionResult.data[0].label, 0.85); // Example confidence
                    downloadLink.style.display = 'block';
                }
            }, 100);

        } catch (error) {
            console.error("Error during prediction:", error);
            showError("Failed: " + (error.message || "Unknown error"));
            progressContainer.style.display = 'none';
        } finally {
            predictBtn.disabled = false;
            predictBtn.textContent = 'Analyze Image';
        }
    }


  // Utility function to convert a File object to a base64 string
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
      });
    }

    function generatePDFReport(filename, prediction, confidence) {
        if (!window.jspdf || !window.jspdf.jsPDF) {
          console.error("jsPDF is not loaded correctly.");
          return;
        }
        const jsPDF = window.jspdf.jsPDF;
        const pdf = new jsPDF();

        if (!filename || !prediction) {
            console.error("Cannot generate PDF: Missing data.", { filename, prediction });
            return;
        }


        pdf.setFontSize(22);
        pdf.setTextColor('#2c3e50');
        pdf.text("MRI Classification Report", 105, 20, { align: "center" });

        const imgData = getBase64Image(document.querySelector('.logos-container img'));
          if (imgData) {
            pdf.addImage(imgData, 'PNG', 25, 22, 30, 15);
        }


        pdf.setFontSize(16);
        pdf.setTextColor('#333333');
        pdf.text(`File Name: ${filename}`, 20, 55);


        pdf.setFontSize(16);
        pdf.setTextColor('#2c3e50');
        pdf.text("Prediction:", 20, 75);
        pdf.setFontSize(14);
        pdf.setTextColor('#27ae60'); // Default to green, change if needed
        if (prediction.includes("Alzheimer's")) {
            pdf.setTextColor('#e74c3c'); // Red for Alzheimer's
        } else if (prediction.includes("MCI")) {
            pdf.setTextColor('#e67e22'); // Orange for MCI
        }
        pdf.text(prediction, 20, 85);



        pdf.setFontSize(14);
        pdf.setTextColor('#2c3e50');
        pdf.text(`Confidence: ${(confidence * 100).toFixed(2)}% (Placeholder)`, 20, 105);
        pdf.text("Explainability: (To be added later - e.g., Grad-CAM visualization)", 20, 115);

        pdf.setFontSize(10);
        pdf.setTextColor('#7f8c8d');
        pdf.text("Generated by [Your Tool Name]", 105, 285, { align: "center" });

        const pdfBlob = pdf.output('blob');
        const pdfUrl = URL.createObjectURL(pdfBlob);

        downloadLink.href = pdfUrl;
        downloadLink.download = `MRI_Classifier_Report_${filename}_${new Date().toISOString().slice(0, 10)}.pdf`;
    }


     function getBase64Image(img) {
        if (!img) {
            console.error("Image element not found");
            return null;
        }
        try{
            const canvas = document.createElement("canvas");
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(img, 0, 0);
            const dataURL = canvas.toDataURL("image/png");
            return dataURL;
        }
        catch (error){
            console.error("Error converting image to base64:", error);
            return null
        }
    }
</script>

</body>
</html>


remove the comments
